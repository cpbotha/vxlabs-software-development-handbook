<meta charset="utf-8" emacsmode="-*- markdown -*-"><link rel="stylesheet" href="https://morgan3d.github.io/markdeep/latest/apidoc.css?">

                        **The vxlabs software development handbook**
                        Version 2020-12-14, [rendered version](https://cpbotha.github.io/vxlabs-software-development-handbook/vxlabs_software_development_handbook.md.html), [github repo](https://github.com/cpbotha/vxlabs-software-development-handbook)
                        by Dr Charl P. Botha <cpbotha@vxlabs.com>

This is the open source vxlabs software development handbook.

It countains a number of best practices for building mostly web-based software
using Python on the backend and TypeScript for the frontend.

I'm making this available under the BSD 3-clause open source license in case
you find any part of this useful. Feel free to pick what works for you, and
ignore the rest.

Keywords: best practices, code style, coding conventions, programming style

Introduction
================================================================================

General
================================================================================

Comment your code
--------------------------------------------------------------------------------

- Where and how does this module fit into the whole product?
- Why exactly is this implemented in a surprising way?
- How does this non-trivial algorithm work?

Prefer TypeScript over JavaScript
--------------------------------------------------------------------------------

Git
================================================================================

Follow the 7 rules of writing good commit messages
--------------------------------------------------------------------------------

See [this blog post by Chris Beams](https://chris.beams.io/posts/git-commit/)
with the motivation and background of these rules.

I repeat the rules below for your convenience:

1. Separate subject from body with a blank line
2. Limit the subject line to 50 characters
3. Capitalize the subject line
4. Do not end the subject line with a period
5. Use the imperative mood in the subject line
6. Wrap the body at 72 characters
7. Use the body to explain what and why vs. how

The post by Beams contains a great example of a rather extensive git commit
message that I reproduce below, also for your convenience.

Commit messages generally stop at the first line, but that means many people
somehow manage to break the first five of the seven rules, so at least pay
careful attention to the example's first line.

``` text
Summarize changes in around 50 characters or less

More detailed explanatory text, if necessary. Wrap it to about 72
characters or so. In some contexts, the first line is treated as the
subject of the commit and the rest of the text as the body. The
blank line separating the summary from the body is critical (unless
you omit the body entirely); various tools like `log`, `shortlog`
and `rebase` can get confused if you run the two together.

Explain the problem that this commit is solving. Focus on why you
are making this change as opposed to how (the code explains that).
Are there side effects or other unintuitive consequences of this
change? Here's the place to explain them.

Further paragraphs come after blank lines.

 - Bullet points are okay, too

 - Typically a hyphen or asterisk is used for the bullet, preceded
   by a single space, with blank lines in between, but conventions
   vary here

If you use an issue tracker, put references to them at the bottom,
like this:

Resolves: #123
See also: #456, #789
```

Usability
================================================================================

- Steve Krug
- design guidelines + opinionated toolkit

Python
================================================================================

Type annotate all the things
--------------------------------------------------------------------------------

Use poetry for package and dependency management
--------------------------------------------------------------------------------

Use the black formatter with defaults
-------------------------------------

The [black formatter documentation makes good arguments for line length
88](https://black.readthedocs.io/en/stable/the_black_code_style.html#line-length),
including that it's more than 80 (can't argue with that), but perhaps most
importantly that longer line lengths could be problematic for folks with sight
difficulties.

Furthermore, sticking to the formatter default means one fewer setting that has
to be modified.

Use flake8 to check your Python as you work
--------------------------------------------------------------------------------

Configure your IDE to apply flake8 checks continuously as you work.

We prefer the google import style (grouped from built-in to third-party, sorted
within groups), and numpy docstrings.

The following `.flake8`, to be installed in the root directory of your project,
takes care of what's mentioned here.

``` config
[flake8]
max-line-length = 88
import-order-style = google
docstring-convention = numpy
# https://black.readthedocs.io/en/stable/the_black_code_style.html#slices
ignore = E203
```


Use cell-based debug scripts
--------------------------------------------------------------------------------

`test_*` and `debug_*`

Prefer Django
--------------------------------------------------------------------------------

Django is the highest quality Python web-framework.

It comes with almost all batteries included, it is exhaustively tested and it
is well-documented.

Importantly, it is quite opinionated, meaning that you don't have to waste time
deciding on alternative solutions for aspects of your back-end. The solutions
are already all there, and they've been battle-tested. However, many of these
components can be swapped out if you really want to.

The Django ORM by itself is worth the price of admission.

In addition to all of that, the large and active community means that:

1. The strange behaviour you're seeing in your app has already been explored,
   documented and fixed by someone else. Just search.
2. There are multiple libraries and configurations for any possible requirement
   you might have.

Sometimes people operate on the assumption that Django is somehow too large for
a small service, and then choose some other smaller-appearing framework.

Why would you do this?

If you use a subset of Django's functionality, it becomes a smaller framework
in memory and in complexity.

However, in future you have the option of switching on any of the built-in
functionality when the project requirements change.

To summarize: Choose Django, unless you have really good and really specific
reasons not to do so.

### What about FastAPI?

We have used [FastAPI](https://fastapi.tiangolo.com/) in the past for a machine
learning project that required asynchronous operation (for pushing results via
websockets to the interactive web frontend) but did not require a database
component or any user authentication.

Although our experience with this impressive piece of software was great, our
Django products have seen many more users and many more years of stable
operation.

Furthermore, since then [Django 3.1 has gained many more async
capabilities](https://docs.djangoproject.com/en/3.1/topics/async/). Faced with
the same requirements today, we might choose differently.

Again, choose Django, unless you have really good and really specific reasons
not to do so.

React
================================================================================

TypeScript
================================================================================

Use the prettier formatter
--------------------------------------------------------------------------------

Using an opinionated and automatic code formatter like
[prettier](https://prettier.io/) saves you time, because you don't have to
think about formatting anymore, and perhaps more importantly, you don't have to
debate about it with anyone.

[prettier recommends against any other `printWidth` than
80](https://prettier.io/docs/en/options.html#print-width), because their
algorithm does not treat it as a maximum length, but rather as a desired
length.

Due to this limitation, and because TypeScript is different from Python, here
we recommend going with prettier's defaults.

Configure your IDE or editor to run prettier automatically on save:

### Visual Studio Code

Install the ["Prettier - Code formatter" extension (extension id:
`esbenp.prettier-vscode`)](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode).

Activate `editor.formatOnSave`.

<style class="fallback">body{visibility:hidden}</style><script>markdeepOptions={tocStyle:'medium'};</script>
<!-- Markdeep: --><script src="https://morgan3d.github.io/markdeep/latest/markdeep.min.js?" charset="utf-8"></script>
